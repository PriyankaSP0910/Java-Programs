mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| db_exe074          |
| information_schema |
| mca074             |
| performance_schema |
+--------------------+
4 rows in set (0.00 sec)

mysql> use mca074;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> show tables;
+------------------+
| Tables_in_mca074 |
+------------------+
| department       |
| dependent        |
| employee         |
| location         |
| manages          |
| projects         |
| workson          |
+------------------+
7 rows in set (0.00 sec)

mysql> select * from project;
ERROR 1146 (42S02): Table 'mca074.project' doesn't exist
mysql> select * from projects;
+------+---------+-----------+--------+
| pid  | pname   | plocation | dep_id |
+------+---------+-----------+--------+
| 1000 | web_app | yelahanka |      1 |
+------+---------+-----------+--------+
1 row in set (0.00 sec)

mysql> alter table projects drop column plocation;
Query OK, 0 rows affected (0.41 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> select * from projects;
+------+---------+--------+
| pid  | pname   | dep_id |
+------+---------+--------+
| 1000 | web_app |      1 |
+------+---------+--------+
1 row in set (0.00 sec)

mysql> create table plocation(ppid int primary key,plocation varchar(50),foreign key(ppid) references projects(p_pid);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1
mysql> select * from projects;
+------+---------+--------+
| pid  | pname   | dep_id |
+------+---------+--------+
| 1000 | web_app |      1 |
+------+---------+--------+
1 row in set (0.01 sec)

mysql> create table plocation(ppid int primary key,plocation varchar(50),foreign key(ppid) references projects(pid);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1
mysql> create table plocation(ppid int primary key,plocation varchar(50),foreign key(ppid) references projects(pid));
Query OK, 0 rows affected (0.57 sec)

mysql> select * from plocation;
Empty set (0.00 sec)

mysql> desc plocation;
+-----------+-------------+------+-----+---------+-------+
| Field     | Type        | Null | Key | Default | Extra |
+-----------+-------------+------+-----+---------+-------+
| ppid      | int         | NO   | PRI | NULL    |       |
| plocation | varchar(50) | YES  |     | NULL    |       |
+-----------+-------------+------+-----+---------+-------+
2 rows in set (0.00 sec)

mysql> show tables;
+------------------+
| Tables_in_mca074 |
+------------------+
| department       |
| dependent        |
| employee         |
| location         |
| manages          |
| plocation        |
| projects         |
| workson          |
+------------------+
8 rows in set (0.00 sec)

mysql> select * from employee;
+-----+---------+--------+--------+-----------+------------+--------+---------+------+------+
| ssn | f_name  | m_name | l_name | address   | b_day      | sex    | salary  | d_no | sid  |
+-----+---------+--------+--------+-----------+------------+--------+---------+------+------+
| 100 | shiva   | b      | malik  | yelahanka | 1989-09-05 | male   | 1000000 | NULL | NULL |
| 200 | shantha | b      | malik  | yelahanka | 1988-09-05 | female | 1200000 | NULL | NULL |
| 300 | ravi    | b      | malik  | yelahanka | 1999-09-05 | male   | 1500000 | NULL | NULL |
+-----+---------+--------+--------+-----------+------------+--------+---------+------+------+
3 rows in set (0.00 sec)

mysql> select * from department;
+------+-----------------+
| d_no | d_name          |
+------+-----------------+
|    1 | quality_control |
|    2 | research        |
|    3 | maintenance     |
+------+-----------------+
3 rows in set (0.00 sec)

mysql> insert into employee(dno) values=1 where ssn=100;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '=1 where ssn=100' at line 1
mysql> insert into employee(dno) values(1) where ssn=100;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where ssn=100' at line 1
mysql> insert into employee(dno) values('1') where ssn=100;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where ssn=100' at line 1
mysql> insert into employee(d_no) values(1) where ssn=100;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where ssn=100' at line 1
mysql> insert into employee(d_no) values(1) where ssn=100;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where ssn=100' at line 1
mysql> delete * from employee;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '* from employee' at line 1
mysql> delete from employee where ssn=100;
Query OK, 1 row affected (0.08 sec)

mysql> delete from employee where ssn=200;
Query OK, 1 row affected (0.10 sec)

mysql> delete from employee where ssn=300;
Query OK, 1 row affected (0.09 sec)

mysql> insert into employee values(100,'shiva','b','malik','1989-07-11','male',50000,1,5);
ERROR 1136 (21S01): Column count doesn't match value count at row 1
mysql> insert into employee values(100,'shiva','b','malik','1989-07-11','male',50000,1);
ERROR 1136 (21S01): Column count doesn't match value count at row 1
mysql> insert into employee values(100,'shiva','b','malik','yelahanka','1989-07-11','male',50000,1,5);
ERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint fails (`mca074`.`employee`, CONSTRAINT `depsid` FOREIGN KEY (`sid`) REFERENCES `employee` (`ssn`))
mysql> insert into employee(ssn,f_name,m_name,l_name,address,b_day,sex,salary,d_no) values(100,'shiva','b','malik','yelahanka','1989-07-11','male',50000,1);
Query OK, 1 row affected (0.14 sec)

mysql> insert into employee(ssn,f_name,m_name,l_name,address,b_day,sex,salary,d_no) values(200,'shantha','b','malik','yelahanka','1999-07-11','female',1000000,1);
Query OK, 1 row affected (0.06 sec)

mysql> insert into employee(ssn,f_name,m_name,l_name,address,b_day,sex,salary,d_no) values(300,'priya','b','malik','yelahanka','2000-07-11','female',2000000,2);
Query OK, 1 row affected (0.10 sec)

mysql> select * from employee;
+-----+---------+--------+--------+-----------+------------+--------+---------+------+------+
| ssn | f_name  | m_name | l_name | address   | b_day      | sex    | salary  | d_no | sid  |
+-----+---------+--------+--------+-----------+------------+--------+---------+------+------+
| 100 | shiva   | b      | malik  | yelahanka | 1989-07-11 | male   |   50000 |    1 | NULL |
| 200 | shantha | b      | malik  | yelahanka | 1999-07-11 | female | 1000000 |    1 | NULL |
| 300 | priya   | b      | malik  | yelahanka | 2000-07-11 | female | 2000000 |    2 | NULL |
+-----+---------+--------+--------+-----------+------------+--------+---------+------+------+
3 rows in set (0.00 sec)

mysql> select * from department;
+------+-----------------+
| d_no | d_name          |
+------+-----------------+
|    1 | quality_control |
|    2 | research        |
|    3 | maintenance     |
+------+-----------------+
3 rows in set (0.00 sec)

mysql> delete from department where d
    -> 
    -> ;
ERROR 1054 (42S22): Unknown column 'd' in 'where clause'
mysql> delete from department where d_no=1;
ERROR 1451 (23000): Cannot delete or update a parent row: a foreign key constraint fails (`mca074`.`employee`, CONSTRAINT `fk_dept_no` FOREIGN KEY (`d_no`) REFERENCES `department` (`d_no`))
mysql> update table department dname='finance' where d_no=1;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'table department dname='finance' where d_no=1' at line 1
mysql> update table department d_name='finance' where d_no=1;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'table department d_name='finance' where d_no=1' at line 1
mysql> update department d_name='finance' where d_no=1;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '='finance' where d_no=1' at line 1
mysql> update department set d_name='finance' where d_no=1;
Query OK, 1 row affected (0.08 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from department;
+------+-------------+
| d_no | d_name      |
+------+-------------+
|    1 | finance     |
|    2 | research    |
|    3 | maintenance |
+------+-------------+
3 rows in set (0.00 sec)

mysql> insert into employee(ssn,f_name,m_name,l_name,address,b_day,sex,salary,d_no) values(400,'namratha','sp','payan','yelahanka','2006-07-11','female',1500000,1);
Query OK, 1 row affected (0.07 sec)

mysql> select * from employee;
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
| ssn | f_name   | m_name | l_name | address   | b_day      | sex    | salary  | d_no | sid  |
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
| 100 | shiva    | b      | malik  | yelahanka | 1989-07-11 | male   |   50000 |    1 | NULL |
| 200 | shantha  | b      | malik  | yelahanka | 1999-07-11 | female | 1000000 |    1 | NULL |
| 300 | priya    | b      | malik  | yelahanka | 2000-07-11 | female | 2000000 |    2 | NULL |
| 400 | namratha | sp     | payan  | yelahanka | 2006-07-11 | female | 1500000 |    1 | NULL |
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
4 rows in set (0.00 sec)

mysql> select e.f_name,m_name,l_name from employee e join department d on e.d_no=d.d_no where e.salary>(select avg(e.salary) from employee e join department d on e.d_no=d.d_no);
+----------+--------+--------+
| f_name   | m_name | l_name |
+----------+--------+--------+
| priya    | b      | malik  |
| namratha | sp     | payan  |
+----------+--------+--------+
2 rows in set (0.01 sec)

mysql> select avg(e.salary) from employee e join department d on e.d_no=d.d_no;
+---------------+
| avg(e.salary) |
+---------------+
|  1137500.0000 |
+---------------+
1 row in set (0.01 sec)

mysql> select e.f_name,m_name,l_name from employee e inner join department d on e.d_no=d.d_no where e.salary>(select avg(e.salary) from employee 
+----------+--------+--------+
| f_name   | m_name | l_name |
+----------+--------+--------+
| priya    | b      | malik  |
| namratha | sp     | payan  |
+----------+--------+--------+
2 rows in set (0.00 sec)

mysql> select e.f_name,m_name,l_name from employee e inner join department d on e.d_no=d.d_no where e.salary>(select avg(e.salary) from employee e join department d on e.d_no=d.d_no);
+----------+--------+--------+
| f_name   | m_name | l_name |
+----------+--------+--------+
| priya    | b      | malik  |
| namratha | sp     | payan  |
+----------+--------+--------+
2 rows in set (0.01 sec)

mysql> select e.f_name,m_name,l_name from employee e inner join department d on e.d_no=d.d_no where e.salary>(select avg(e.salary) from employee e join department d on e.d_no=d.d_no) and d.d_name!='finance';
+--------+--------+--------+
| f_name | m_name | l_name |
+--------+--------+--------+
| priya  | b      | malik  |
+--------+--------+--------+
1 row in set (0.01 sec)

mysql> select avg(e.salary) from employee e join department d on e.d_no=d.d_no;
+---------------+
| avg(e.salary) |
+---------------+
|  1137500.0000 |
+---------------+
1 row in set (0.00 sec)

mysql> select e.f_name,m_name,l_name from employee e inner join department d on e.d_no=d.d_no where e.salary>(select avg(e.salary) from employee e join department d on e.d_no=d.d_no) and d.d_name!='finance';
+--------+--------+--------+
| f_name | m_name | l_name |
+--------+--------+--------+
| priya  | b      | malik  |
+--------+--------+--------+
1 row in set (0.00 sec)

mysql> select * from employee;
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
| ssn | f_name   | m_name | l_name | address   | b_day      | sex    | salary  | d_no | sid  |
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
| 100 | shiva    | b      | malik  | yelahanka | 1989-07-11 | male   |   50000 |    1 | NULL |
| 200 | shantha  | b      | malik  | yelahanka | 1999-07-11 | female | 1000000 |    1 | NULL |
| 300 | priya    | b      | malik  | yelahanka | 2000-07-11 | female | 2000000 |    2 | NULL |
| 400 | namratha | sp     | payan  | yelahanka | 2006-07-11 | female | 1500000 |    1 | NULL |
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
4 rows in set (0.00 sec)

mysql> select * from projects;
+------+---------+--------+
| pid  | pname   | dep_id |
+------+---------+--------+
| 1000 | web_app |      1 |
+------+---------+--------+
1 row in set (0.00 sec)

mysql> select * from department;
+------+-------------+
| d_no | d_name      |
+------+-------------+
|    1 | finance     |
|    2 | research    |
|    3 | maintenance |
+------+-------------+
3 rows in set (0.01 sec)

mysql> update department set d_name='R&D' where d_no=2;
Query OK, 1 row affected (0.10 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> insert into projects values(1001,'open_AI',2);
Query OK, 1 row affected (0.08 sec)

mysql> insert into projects values(1002,'payment_integration',2);
Query OK, 1 row affected (0.11 sec)

mysql> insert into projects values(1002,'botique',3);
ERROR 1062 (23000): Duplicate entry '1002' for key 'projects.PRIMARY'
mysql> insert into projects values(1003,'botique',3);
Query OK, 1 row affected (0.12 sec)

mysql> select e.f_name,e.m_name,e.l_name from employee e join department d on e.d_no=d.d_no join projects p on p.dep_id=d.d_no where 
    -> ;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1
mysql> select * from projects;
+------+---------------------+--------+
| pid  | pname               | dep_id |
+------+---------------------+--------+
| 1000 | web_app             |      1 |
| 1001 | open_AI             |      2 |
| 1002 | payment_integration |      2 |
| 1003 | botique             |      3 |
+------+---------------------+--------+
4 rows in set (0.00 sec)

mysql> select * from department;
+------+-------------+
| d_no | d_name      |
+------+-------------+
|    1 | finance     |
|    2 | R&D         |
|    3 | maintenance |
+------+-------------+
3 rows in set (0.00 sec)

mysql> select * from employee;
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
| ssn | f_name   | m_name | l_name | address   | b_day      | sex    | salary  | d_no | sid  |
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
| 100 | shiva    | b      | malik  | yelahanka | 1989-07-11 | male   |   50000 |    1 | NULL |
| 200 | shantha  | b      | malik  | yelahanka | 1999-07-11 | female | 1000000 |    1 | NULL |
| 300 | priya    | b      | malik  | yelahanka | 2000-07-11 | female | 2000000 |    2 | NULL |
| 400 | namratha | sp     | payan  | yelahanka | 2006-07-11 | female | 1500000 |    1 | NULL |
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
4 rows in set (0.01 sec)

mysql> select avg(e.salary) from employee e join department d on e.d_no=d.d_no;
+---------------+
| avg(e.salary) |
+---------------+
|  1137500.0000 |
+---------------+
1 row in set (0.00 sec)

mysql> select e.f_name,m_name,l_name from employee e inner join department d on e.d_no=d.d_no where e.salary>(select avg(e.salary) from employee e join department d on e.d_no=d.d_no);
+----------+--------+--------+
| f_name   | m_name | l_name |
+----------+--------+--------+
| priya    | b      | malik  |
| namratha | sp     | payan  |
+----------+--------+--------+
2 rows in set (0.00 sec)

mysql> select * from department;
+------+-------------+
| d_no | d_name      |
+------+-------------+
|    1 | finance     |
|    2 | R&D         |
|    3 | maintenance |
+------+-------------+
3 rows in set (0.00 sec)

mysql> select e.f_name,e.m_name,e.l_name from employee e join department d on e.d_no=d.d_no join projects p on p.dep_id=d.d_no where d.d_no=p.dep_id and count(p.pid)>=2;
ERROR 1111 (HY000): Invalid use of group function
mysql> select e.f_name,e.m_name,e.l_name from employee e join department d on e.d_no=d.d_no join projects p on p.dep_id=d.d_no group by p.pid
where d.d_no=p.dep_id and count(p.pid)>=2;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where d.d_no=p.dep_id and count(p.pid)>=2' at line 1
mysql> select * from workson
    -> ;
Empty set (0.00 sec)

mysql> desc workson;
+-------+------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+-------+------+------+-----+---------+-------+
| w_ssn | int  | NO   | PRI | NULL    |       |
| w_pid | int  | NO   | PRI | NULL    |       |
| hours | int  | YES  |     | NULL    |       |
+-------+------+------+-----+---------+-------+
3 rows in set (0.00 sec)

mysql> select e.f_name,e.m_name,e.l_name from employee e join department d on e.d_no=d.d_no join projects p on p.dep_id=d.d_no  where d.dname='R&D' and d.d_no=p.dep_id group by e.f_name,e.m_name,e.l_name,d.d_name having count(p.pid)>=2;
ERROR 1054 (42S22): Unknown column 'd.dname' in 'where clause'
mysql> select e.f_name,e.m_name,e.l_name from employee e join department d on e.d_no=d.d_no join projects p on p.dep_id=d.d_no  where d.d_name='R&D' and d.d_no=p.dep_id group by e.f_name,e.m_name,e.l_name,d.d_name having count(p.pid)>=2;
+--------+--------+--------+
| f_name | m_name | l_name |
+--------+--------+--------+
| priya  | b      | malik  |
+--------+--------+--------+
1 row in set (0.00 sec)

mysql> desc workson;
+-------+------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+-------+------+------+-----+---------+-------+
| w_ssn | int  | NO   | PRI | NULL    |       |
| w_pid | int  | NO   | PRI | NULL    |       |
| hours | int  | YES  |     | NULL    |       |
+-------+------+------+-----+---------+-------+
3 rows in set (0.00 sec)

mysql> insert into workson(300,1000,8);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '300,1000,8)' at line 1
mysql> insert into workson values(300,1000,8);
Query OK, 1 row affected (0.07 sec)

mysql> insert into workson values(300,1001,10);
Query OK, 1 row affected (0.10 sec)

mysql> insert into workson values(200,1003,8);
Query OK, 1 row affected (0.09 sec)

mysql> select * from workson;
+-------+-------+-------+
| w_ssn | w_pid | hours |
+-------+-------+-------+
|   200 |  1003 |     8 |
|   300 |  1000 |     8 |
|   300 |  1001 |    10 |
+-------+-------+-------+
3 rows in set (0.00 sec)

mysql> select * from employee;
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
| ssn | f_name   | m_name | l_name | address   | b_day      | sex    | salary  | d_no | sid  |
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
| 100 | shiva    | b      | malik  | yelahanka | 1989-07-11 | male   |   50000 |    1 | NULL |
| 200 | shantha  | b      | malik  | yelahanka | 1999-07-11 | female | 1000000 |    1 | NULL |
| 300 | priya    | b      | malik  | yelahanka | 2000-07-11 | female | 2000000 |    2 | NULL |
| 400 | namratha | sp     | payan  | yelahanka | 2006-07-11 | female | 1500000 |    1 | NULL |
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
4 rows in set (0.00 sec)

mysql> select * from department;
+------+-------------+
| d_no | d_name      |
+------+-------------+
|    1 | finance     |
|    2 | R&D         |
|    3 | maintenance |
+------+-------------+
3 rows in set (0.00 sec)

mysql> select * from projects;
+------+---------------------+--------+
| pid  | pname               | dep_id |
+------+---------------------+--------+
| 1000 | web_app             |      1 |
| 1001 | open_AI             |      2 |
| 1002 | payment_integration |      2 |
| 1003 | botique             |      3 |
+------+---------------------+--------+
4 rows in set (0.00 sec)

mysql> select e.f_name,e.m_name,e.l_name from employee e join department d on e.d_no=d.d_no join projects p on p.dep_id=d.d_no  where d.d_name='R&D' and d.d_no=p.dep_id group by e.f_name,e.m_name,e.l_name,d.d_name having count(p.pid)>=2;
+--------+--------+--------+
| f_name | m_name | l_name |
+--------+--------+--------+
| priya  | b      | malik  |
+--------+--------+--------+
1 row in set (0.00 sec)

mysql> select e.f_name,m_name,l_name from employee e join department d on e.d_no=d.d_no join workson w on w_ssn=e.ssn join projects p on p.pid=w.w_pid where d.dname='R&D' where p.pid=d.d_no group by e.f_name,e.m_name,e.l_name,d.d_name having count(w.w_pid)>=2;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where p.pid=d.d_no group by e.f_name,e.m_name,e.l_name,d.d_name having count(w.w' at line 1
mysql> select e.f_name,e.m_name,e.l_name from employee e join department d on e.d_no=d.d_no join workson w on w.w_ssn=e.ssn join projects p on
 p.pid=w.w_pid where d.d_name='R&D' where p.pid=d.d_no group by e.f_name,e.m_name,e.l_name,d.d_name having count(w.w_pid)>=2;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where p.pid=d.d_no group by e.f_name,e.m_name,e.l_name,d.d_name having count(w.w' at line 1
mysql> select e.f_name,e.m_name,e.l_name from employee e join department d on e.d_no=d.d_no join workson w on w.w_ssn=e.ssn join projects p on p.pid=w.w_pid where d.d_name='R&D' where p.pid=d.d_no group by e.f_name,e.m_name,e.l_name,d.d_name having count(w.w_pid)>=2;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where p.pid=d.d_no group by e.f_name,e.m_name,e.l_name,d.d_name having count(w.w' at line 1
mysql> select e.fname,e.lname,d.dname from employee e join department d on e.did=d.did join works_on w on w.ssn=e.ssn join project p on p.pid=w.pid where d.dname='R&D' and p.did=d.did group by e.fname,e.lname,d.dname having count(w.pid)>2;
ERROR 1146 (42S02): Table 'mca074.works_on' doesn't exist
mysql> select e.fname,e.lname,d.dname from employee e join department d on e.did=d.did join works_on w on w.ssn=e.ssn join project p on p.pid=w.pid where d.dname='R&D' and p.did=d.did group by e.fname,e.lname,d.dname having count(w.pid)>2;
ERROR 1146 (42S02): Table 'mca074.works_on' doesn't exist
mysql> select e.f_name,e.m_name,e.l_name from employee e join department d on e.d_no=d.d_no join workson w w.w_ssn=e.ssn join projects on p.pid=w.w_pid where d.d_name='R&D' and p.dep_id=d.d_no group by e.f_name,e.m_name,e.l_name,d.d_name having count(w.w_pid)>=1;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'w.w_ssn=e.ssn join projects on p.pid=w.w_pid where d.d_name='R&D' and p.dep_id=d' at line 1
mysql> select e.f_name,e.m_name,e.l_name from employee e join department d on e.d_no=d.d_no join workson w w.w_ssn=e.ssn join projects on p.pid=w.w_pid where d.d_name='R&D' and p.dep_id=d.d_no group by e.f_name,e.m_name,e.l_name,d.d_name having count(w.w_pid)>1;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'w.w_ssn=e.ssn join projects on p.pid=w.w_pid where d.d_name='R&D' and p.dep_id=d' at line 1
mysql> select e.f_name,e.m_name,e.l_name from employee e join department d on e.d_no=d.d_no join workson w e.ssn=w.w_ssn join projects on p.pid=w.w_pid where d.d_name='R&D' and p.dep_id=d.d_no group by e.f_name,e.m_name,e.l_name,d.d_name having count(w.w_pid)>1;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'e.ssn=w.w_ssn join projects on p.pid=w.w_pid where d.d_name='R&D' and p.dep_id=d' at line 1
mysql> select e.f_name,e.m_name,e.l_name from employee e join department d on e.d_no=d.d_no join workson w e.ssn=w.w_ssn join projects on p.pid=w.w_pid where d.d_name='R&D' and p.dep_id=d.d_no group by e.f_name,e.m_name,e.l_name,d.d_name having count(w.w_pid)>1;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'e.ssn=w.w_ssn join projects on p.pid=w.w_pid where d.d_name='R&D' and p.dep_id=d' at line 1
mysql> select e.fname,e.lname,d.dname from employee e join department d on e.did=d.did join works_on w on w.ssn=e.ssn join project p on p.pid=w.pid where d.dname='R&D' and p.did=d.did group by e.fname,e.lname,d.dname having count(w.pid)>2;
ERROR 1146 (42S02): Table 'mca074.works_on' doesn't exist
mysql> 
mysql> 
mysql> select e.fname,e.lname,d.dname from employee e join department d on e.did=d.did join works_on w on w.ssn=e.ssn join project p on p.pid=w.pid where d.dname='R&D' and p.did=d.did group by e.fname,e.lname,d.dname having count(w.pid)>2;
ERROR 1146 (42S02): Table 'mca074.works_on' doesn't exist
mysql> select e.f_name,e.m_name,e.l_name from employee e join department d on e.d_no=d.d_no join workson w e.ssn=w.w_ssn join projects on p.pid=w.w_pid where d.d_name='R&D' and p.dep_id=d.d_no group by e.f_name,e.m_name,e.l_name,d.d_name having count(w.w_pid)>1;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'e.ssn=w.w_ssn join projects on p.pid=w.w_pid where d.d_name='R&D' and p.dep_id=d' at line 1
mysql> select e.f_name,e.m_name,e.l_name,d.d_name from employee e join department d on e.d_no=d.d_no join workson w on e.ssn=w.w_ssn join proj
ects on p.pid=w.w_pid where d.d_name='R&D' and p.dep_id=d.d_no group by e.f_name,e.m_name,e.l_name,d.d_name having count(w.w_pid)>1;
ERROR 1054 (42S22): Unknown column 'p.dep_id' in 'where clause'
mysql> select e.f_name,e.m_name,e.l_name,d.d_name from employee e join department d on e.d_no=d.d_no join workson w on e.ssn=w.w_ssn join projects p on p.pid=w.w_pid where d.d_name='R&D' and p.dep_id=d.d_no group by e.f_name,e.m_name,e.l_name,d.d_name having count(w.w_pid)>1;
Empty set (0.00 sec)

mysql> select e.f_name,e.m_name,e.l_name,d.d_name from employee e inner join department d on e.d_no=d.d_no inner join workson w on e.ssn=w.w_ssn inner join projects p on p.pid=w.w_pid where d.d_name='R&D' and p.dep_id=d.d_no group by e.f_name,e.m_name,e.l_name,d.d_name having count(
.w_pid)>1;
Empty set (0.00 sec)

mysql> select e.f_name,e.m_name,e.l_name,d.d_name from employee e inner join department d on e.d_no=d.d_no inner join workson w on e.ssn=w.w_ssn inner join projects p on p.pid=w.w_pid where d.d_name='R&D' and e.ssn=w.w_ssn and p.pid=w.w_pid group by e.f_name,e.m_name,e.l_name,d.d_nam
e having count(w.w_pid)>1;
+--------+--------+--------+--------+
| f_name | m_name | l_name | d_name |
+--------+--------+--------+--------+
| priya  | b      | malik  | R&D    |
+--------+--------+--------+--------+
1 row in set (0.00 sec)

mysql> select * from employee;
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
| ssn | f_name   | m_name | l_name | address   | b_day      | sex    | salary  | d_no | sid  |
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
| 100 | shiva    | b      | malik  | yelahanka | 1989-07-11 | male   |   50000 |    1 | NULL |
| 200 | shantha  | b      | malik  | yelahanka | 1999-07-11 | female | 1000000 |    1 | NULL |
| 300 | priya    | b      | malik  | yelahanka | 2000-07-11 | female | 2000000 |    2 | NULL |
| 400 | namratha | sp     | payan  | yelahanka | 2006-07-11 | female | 1500000 |    1 | NULL |
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
4 rows in set (0.00 sec)

mysql> insert into employee(sid) values(100) where ssn=100;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where ssn=100' at line 1
mysql> insert into employee(ssn,f_name,m_name,l_name,address,b_day,sex,salary,d_no) values(400,'namratha','sp','payan','yelahanka','2006-07-11','female',1500000,1);
ERROR 1062 (23000): Duplicate entry '400' for key 'employee.PRIMARY'
mysql> insert into employee(ssn,f_name,m_name,l_name,address,b_day,sex,salary,d_no,sid) values(500,'raj','sp','payan','yelahanka','2006-07-11','male',1500000,1,100);
Query OK, 1 row affected (0.14 sec)

mysql> insert into employee(ssn,f_name,m_name,l_name,address,b_day,sex,salary,d_no,sid) values(600,'bharath','sp','payan','yelahanka','2006-07-11'
Query OK, 1 row affected (0.07 sec)

mysql> insert into employee(ssn,f_name,m_name,l_name,address,b_day,sex,salary,d_no,sid) values(700,'ravi','sp','payan','yelahanka','2006-07-11','male',1500000,1,100);
Query OK, 1 row affected (0.12 sec)

mysql> insert into employee(ssn,f_name,m_name,l_name,address,b_day,sex,salary,d_no,sid) values(800,'mahesh','sp','payan','yelahanka','2006-07-11'
Query OK, 1 row affected (0.10 sec)

mysql> insert into employee(ssn,f_name,m_name,l_name,address,b_day,sex,salary,d_no,sid) values(900,'akash','sp','payan','yelahanka','2006-07-11'
Query OK, 1 row affected (0.09 sec)

mysql> select * from projects;
+------+---------------------+--------+
| pid  | pname               | dep_id |
+------+---------------------+--------+
| 1000 | web_app             |      1 |
| 1001 | open_AI             |      2 |
| 1002 | payment_integration |      2 |
| 1003 | botique             |      3 |
+------+---------------------+--------+
4 rows in set (0.00 sec)

mysql> select * from workson;
+-------+-------+-------+
| w_ssn | w_pid | hours |
+-------+-------+-------+
|   200 |  1003 |     8 |
|   300 |  1000 |     8 |
|   300 |  1001 |    10 |
+-------+-------+-------+
3 rows in set (0.00 sec)

mysql> select * from employee;
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
| ssn | f_name   | m_name | l_name | address   | b_day      | sex    | salary  | d_no | sid  |
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
| 100 | shiva    | b      | malik  | yelahanka | 1989-07-11 | male   |   50000 |    1 | NULL |
| 200 | shantha  | b      | malik  | yelahanka | 1999-07-11 | female | 1000000 |    1 | NULL |
| 300 | priya    | b      | malik  | yelahanka | 2000-07-11 | female | 2000000 |    2 | NULL |
| 400 | namratha | sp     | payan  | yelahanka | 2006-07-11 | female | 1500000 |    1 | NULL |
| 500 | raj      | sp     | payan  | yelahanka | 2006-07-11 | male   | 1500000 |    1 |  100 |
| 600 | bharath  | sp     | payan  | yelahanka | 2006-07-11 | male   | 1500000 |    1 |  100 |
| 700 | ravi     | sp     | payan  | yelahanka | 2006-07-11 | male   | 1500000 |    1 |  100 |
| 800 | mahesh   | sp     | payan  | yelahanka | 2006-07-11 | male   | 1500000 |    1 |  100 |
| 900 | akash    | sp     | payan  | yelahanka | 2006-07-11 | male   | 1500000 |    1 |  100 |
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
9 rows in set (0.00 sec)

mysql> insert into workson values(500,1000,8);
Query OK, 1 row affected (0.09 sec)

mysql> insert into workson values(600,1000,8);
Query OK, 1 row affected (0.07 sec)

mysql> insert into workson values(700,1001,8);
Query OK, 1 row affected (0.09 sec)

mysql> select e.ssn,e.fname,e.lname from employee e join workson w on w.w_ssn=e.ssn join projects p on p.pid=w.w_pid where 
    -> ;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1
mysql> select * from projects;
+------+---------------------+--------+
| pid  | pname               | dep_id |
+------+---------------------+--------+
| 1000 | web_app             |      1 |
| 1001 | open_AI             |      2 |
| 1002 | payment_integration |      2 |
| 1003 | botique             |      3 |
+------+---------------------+--------+
4 rows in set (0.00 sec)

mysql> select * from workson;
+-------+-------+-------+
| w_ssn | w_pid | hours |
+-------+-------+-------+
|   200 |  1003 |     8 |
|   300 |  1000 |     8 |
|   300 |  1001 |    10 |
|   500 |  1000 |     8 |
|   600 |  1000 |     8 |
|   700 |  1001 |     8 |
+-------+-------+-------+
6 rows in set (0.00 sec)

mysql> select e.ssn,e.fname,e.lname from employee e join workson w on w.w_ssn=e.ssn join projects p on p.pid=w.w_pid where w.w_ssn=e.ssn group by e.ssn,e.f_name,e.l_name having count(e.ssn)>3 and count(distinct(w.w_pid)>3);
ERROR 1054 (42S22): Unknown column 'e.fname' in 'field list'
mysql> select e.ssn,e.f_name,e.l_name from employee e join workson w on w.w_ssn=e.ssn join projects p on p.pid=w.w_pid where w.w_ssn=e.ssn group by e.ssn,e.f_name,e.l_name having count(e.ssn)>3 and count(distinct(w.w_pid)>3);
Empty set (0.00 sec)

mysql> select * from employee;
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
| ssn | f_name   | m_name | l_name | address   | b_day      | sex    | salary  | d_no | sid  |
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
| 100 | shiva    | b      | malik  | yelahanka | 1989-07-11 | male   |   50000 |    1 | NULL |
| 200 | shantha  | b      | malik  | yelahanka | 1999-07-11 | female | 1000000 |    1 | NULL |
| 300 | priya    | b      | malik  | yelahanka | 2000-07-11 | female | 2000000 |    2 | NULL |
| 400 | namratha | sp     | payan  | yelahanka | 2006-07-11 | female | 1500000 |    1 | NULL |
| 500 | raj      | sp     | payan  | yelahanka | 2006-07-11 | male   | 1500000 |    1 |  100 |
| 600 | bharath  | sp     | payan  | yelahanka | 2006-07-11 | male   | 1500000 |    1 |  100 |
| 700 | ravi     | sp     | payan  | yelahanka | 2006-07-11 | male   | 1500000 |    1 |  100 |
| 800 | mahesh   | sp     | payan  | yelahanka | 2006-07-11 | male   | 1500000 |    1 |  100 |
| 900 | akash    | sp     | payan  | yelahanka | 2006-07-11 | male   | 1500000 |    1 |  100 |
+-----+----------+--------+--------+-----------+------------+--------+---------+------+------+
9 rows in set (0.00 sec)

mysql> select e.ssn,e.f_name,e.l_name from employee e join workson w on w.w_ssn=e.ssn join projects p on p.pid=w.w_pid where w.w_ssn=e.ssn group by e.ssn,e.f_name,e.l_name having count(w.w_pid)>3;
Empty set (0.00 sec)

mysql> select e.ssn,e.f_name,e.l_name from employee e join workson w on w.w_ssn=e.ssn join projects p on p.pid=w.w_pid where w.w_ssn=e.ssn and p.pid=w.w_pid group by e.ssn,e.f_name,e.l_name having count(distinct(w.w_pid)>3);
+-----+---------+--------+
| ssn | f_name  | l_name |
+-----+---------+--------+
| 200 | shantha | malik  |
| 300 | priya   | malik  |
| 500 | raj     | payan  |
| 600 | bharath | payan  |
| 700 | ravi    | payan  |
+-----+---------+--------+
5 rows in set (0.00 sec)

mysql> select e.ssn,e.f_name,e.l_name from employee e join workson w on w.w_ssn=e.ssn join projects p on p.pid=w.w_pid where w.w_ssn=e.ssn and p.pid=w.w_pid group by e.ssn,e.f_name,e.l_name having count(select distict(w.w_pid)from workson);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'select distict(w.w_pid)from workson)' at line 1
mysql> select e.ssn,e.f_name,e.l_name from employee e join workson w on w.w_ssn=e.ssn join projects p on p.pid=w.w_pid where w.w_ssn=e.ssn and p.pid=w.w_pid group by e.ssn,e.f_name,e.l_name having count(select distict(w.w_pid) from workson);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'select distict(w.w_pid) from workson)' at line 1
mysql> select e.ssn,e.f_name,e.l_name from employee e join workson w on w.w_ssn=e.ssn join projects p on p.pid=w.w_pid where w.w_ssn=e.ssn and p.pid=w.w_pid group by e.ssn,e.f_name,e.l_name having count(select distict(w.w_pid) from workson);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'select distict(w.w_pid) from workson)' at line 1
mysql> select e.ssn,e.f_name,e.l_name from employee e join workson w on w.w_ssn=e.ssn join projects p on p.pid=w.w_pid where w.w_ssn=e.ssn and p.pid=w.w_pid group by e.ssn,e.f_name,e.l_name having count distinct(w.w_pid)>3;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'distinct(w.w_pid)>3' at line 1
mysql> select e.ssn,e.f_name,e.l_name from employee e join workson w on w.w_ssn=e.ssn join projects p on p.pid=w.w_pid where w.w_ssn=e.ssn and p.pid=w.w_pid group by e.ssn,e.f_name,e.l_name having count(distinct(w.w_pid))>3;
Empty set (0.00 sec)

mysql> select e.ssn,e.f_name,e.l_name from employee e join workson w on w.w_ssn=e.ssn join projects p on p.pid=w.w_pid where w.w_ssn=e.ssn and p.pid=w.w_pid group by e.ssn,e.f_name,e.l_name having count(distinct(w.w_pid)>3);
+-----+---------+--------+
| ssn | f_name  | l_name |
+-----+---------+--------+
| 200 | shantha | malik  |
| 300 | priya   | malik  |
| 500 | raj     | payan  |
| 600 | bharath | payan  |
| 700 | ravi    | payan  |
+-----+---------+--------+
5 rows in set (0.00 sec)

mysql> insert into employee(ssn,f_name,m_name,l_name,address,b_day,sex,salary,d_no,sid) values(900,'akash','sp','payan','yelahanka','2006-07-11','male',1500000,1,100);


